@using GoldEx.Shared.DTOs.PriceUnits
@inherits GoldExComponentBase

<MudForm Model="Model" @ref="@_form" Validation="@(_bankAccountValidator.ValidateValue)" ValidationDelay="0">
    <MudDialog>
        <DialogContent>
            <MudGrid>
                <MudItem xs="12">
                    <MudStack Row Justify="Justify.SpaceBetween" AlignItems="AlignItems.Center">
                        <MudText>نوع حساب:</MudText>
                        <MudRadioGroup T="BankAccountType" Required="true" For="() => Model.BankAccountType" Value="Model.BankAccountType" ValueChanged="OnAccountTypeChanged">
                            <MudRadio Value="@(BankAccountType.Local)">@BankAccountType.Local.GetDisplayName()</MudRadio>
                            <MudRadio Value="@(BankAccountType.International)">@BankAccountType.International.GetDisplayName()</MudRadio>
                        </MudRadioGroup>
                    </MudStack>
                </MudItem>
                <MudItem xs="12" md="6">
                    <MudTextField @bind-Value="Model.BankName"
                                  For="@(() => Model.BankName)"
                                  Label="@(Model.GetDisplayName(() => Model.BankName))"
                                  Margin="Margin.Dense"
                                  Variant="Variant.Outlined" />
                </MudItem>
                <MudItem xs="12" md="6">
                    <MudTextField @bind-Value="Model.AccountHolderName"
                                  For="@(() => Model.AccountHolderName)"
                                  Label="@(Model.GetDisplayName(() => Model.AccountHolderName))"
                                  Margin="Margin.Dense"
                                  Variant="Variant.Outlined" />
                </MudItem>
                @if (Model.BankAccountType is BankAccountType.International)
                {
                    <MudItem xs="12" md="6">
                        <MudSelect T="GetPriceUnitTitleResponse?"
                                   @bind-Value="Model.PriceUnit"
                                   Label="@Model.GetDisplayName(() => Model.PriceUnit)"
                                   For="() => Model.PriceUnit"
                                   FitContent="true"
                                   FullWidth="true"
                                   Margin="Margin.Dense"
                                   Variant="Variant.Outlined">
                            @foreach (var item in PriceUnits)
                            {
                                <MudSelectItem Value="item">
                                    <MudStack Row AlignItems="AlignItems.Center" Spacing="2">
                                        <MudAvatar Size="Size.Small">
                                            <MudImage Src="@(ApiUrls.Icons.Get(IconType.PriceUnit, item.Id))" Alt="@item.Title" />
                                        </MudAvatar>
                                        <MudText Class="d-none d-md-inline">@item.Title</MudText>
                                    </MudStack>
                                </MudSelectItem>
                            }
                        </MudSelect>
                    </MudItem>
                    <MudItem xs="12" md="6">
                        <MudTextField @bind-Value="Model.InternationalAccountNumber"
                                      For="@(() => Model.InternationalAccountNumber)"
                                      Label="@(Model.GetDisplayName(() => Model.InternationalAccountNumber))"
                                      Margin="Margin.Dense"
                                      Variant="Variant.Outlined" />
                    </MudItem>
                    <MudItem xs="12" md="6">
                        <MudTextField @bind-Value="Model.SwiftBicCode"
                                      For="@(() => Model.SwiftBicCode)"
                                      Label="@(Model.GetDisplayName(() => Model.SwiftBicCode))"
                                      Margin="Margin.Dense"
                                      Variant="Variant.Outlined" />
                    </MudItem>
                    <MudItem xs="12" md="6">
                        <MudTextField @bind-Value="Model.IbanNumber"
                                      For="@(() => Model.IbanNumber)"
                                      Label="@(Model.GetDisplayName(() => Model.IbanNumber))"
                                      Margin="Margin.Dense"
                                      Variant="Variant.Outlined" />
                    </MudItem>
                }
                else if (Model.BankAccountType is BankAccountType.Local)
                {
                    <MudItem xs="12" md="6">
                        <MudTextField @bind-Value="Model.LocalAccountNumber"
                                      For="@(() => Model.LocalAccountNumber)"
                                      Label="@(Model.GetDisplayName(() => Model.LocalAccountNumber))"
                                      Margin="Margin.Dense"
                                      Variant="Variant.Outlined" />
                    </MudItem>
                    <MudItem xs="12" md="6">
                        <MudTextField @bind-Value="Model.CardNumber"
                                      For="@(() => Model.CardNumber)"
                                      Label="@(Model.GetDisplayName(() => Model.CardNumber))"
                                      Margin="Margin.Dense"
                                      Variant="Variant.Outlined" />
                    </MudItem>
                    <MudItem xs="12">
                        <MudTextField @bind-Value="Model.ShabaNumber"
                                      For="@(() => Model.ShabaNumber)"
                                      Label="@(Model.GetDisplayName(() => Model.ShabaNumber))"
                                      Margin="Margin.Dense"
                                      Variant="Variant.Outlined" />
                    </MudItem>
                }
            </MudGrid>
        </DialogContent>
        <DialogActions>
            <MudButton Color="Color.Error"
                       OnClick="Close"
                       StartIcon="@Icons.Material.Filled.Close"
                       Variant="Variant.Filled">بستن</MudButton>

            <MudButton Class="m-2"
                       Color="Color.Primary"
                       StartIcon="@Icons.Material.Filled.Save"
                       OnClick="@(() => Submit())"
                       Variant="Variant.Filled">
                <MudText>ذخیره</MudText>
            </MudButton>
        </DialogActions>
    </MudDialog>
</MudForm>